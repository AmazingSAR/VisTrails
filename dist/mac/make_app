#!/usr/bin/env sh
echo "removing build and dist folders..."
rm -rf dist/ build/
echo "building bundle..."
python setup.py py2app
echo "copying dot and its libraries to the right place..."
cp Input/dot dist/VisTrails.app/Contents/MacOS/
cp -r Input/Frameworks/* dist/VisTrails.app/Contents/Frameworks/
echo "copying missing xml.etree.cElementTree imports..."
cp /Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/lib-dynload/pyexpat.so dist/VisTrails.app/Contents/Resources/lib/python2.5/lib-dynload/
cp /Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/lib-dynload/_elementtree.so dist/VisTrails.app/Contents/Resources/lib/python2.5/lib-dynload/
cp -r /Library/Frameworks/Python.framework/Versions/2.5/lib/python2.5/xml dist/VisTrails.app/Contents/Resources/lib/python2.5/
echo "copying qt.conf..."
cp Input/qt.conf dist/VisTrails.app/Contents/Resources/
echo "copying plugins..."
cp -r Input/plugins/* dist/Vistrails.app/Contents/MacOS/
echo "copying examples folder..."
cp -r Input/examples dist/
echo "copying README file..."
cp Input/README dist/
echo "Done."